defmodule MerkleSHA3_512HexTest do
  use ExUnit.Case

  defmodule Tree do
    use Merkle, {&Merkle.Mixers.Hex.sha3_512/2, 64}
  end

  @foo "4BCA2B137EDC580FE50A88983EF860EBACA36C857B1F492839D6D7392452A63C82CBEBC68E3B70A2A1480B4BB5D437A7CBA6ECF9D89F9FF3CCD14CD6146EA7E7"

  @hashes ["A69F73CCA23A9AC5C8B567DC185A756E97C982164FE25859E0D1DCC1475C80A615B2123AF1F5F94C11E3E9402C3AC558F500199D95B6D3E301758586281DCD26",
          "7127AAB211F82A18D06CF7578FF49D5089017944139AA60D8BEE057811A15FB55A53887600A3ECEBA004DE51105139F32506FE5B53E1913BFA6B32E716FE97DA",
          "71CB4A0B4D323A3D9D6F8188DB4D3266A298053C660A5152AFEBD0782D07820D7AF7E4B1F327E150753FD5CC84B3CF949F33F7A64D62CD764C154F3EEC100F7D",
          "0A7B1406BE477B9B994A976A49A236DDF177EA65D04E770264B32C240EB229603F05B573772D406FBB321B8A80F90E73A8EAC5182E2DACB1E93B37C9AE380C37",
          "82BB78ACCCED463DB810E506218AD1CE4D702491A4921D55075985BADB2CF73C1F9D9035CA83CF383505DCBEA17542943ECDC9E4C476D1C0A97C891AF6F2772B",
          "BDA962340F636E37E98903953944CFE22D8F1EF6B564E5BEA44A575F2500648F35E286F7A6DBBB26E52246151A6CD055ED7370173A2927A9683F25143844FFA8",
          "68782E54497296A64B14987023A61F96B741B1F2F7FF6095552569A2252783C85C99E9FA43273A196FFA0FF72697C3449682175C6272B8586DEF3CED6E701B37",
          "0A28B1EEBA45E166119CE95B6CF76B24946BA8DADAA4B7C10AFF72272BFEF3AF1408ED34F1AAE2C8F65EDFC29F0CA8997A9DC9C6953484A0F2DE1A35E0278168",
          "0ADE1DB9CC8552ED5997A5642D835EBD191367D08C24564A735A16F777EC7A0F02E7575E5C778E39D6CDFA79006CD96BC4B40967ABBC23B9109EED2F296AF8F6",
          "259CED9D6AF7A7D157938A10D617E480B1E5D498D8B1AA6F854A90AC4639917E4FC03DCF05EA49FC2B50CAB81F32C4D6B38396FF7975F22342F0050E88870F3A",
          "E12F775ADFB4E440B74AF7B670849A44B7EFD1612A97A3A201080CB31944F1F2D9F0EAE6B7C0CDB602F6FF0BA181ADD9997FD06E43F992DF577AA52153CA0D27",
          "B8B697048ECCEB141A7AD801A21A9459C2DB367D7A3699401BAC77DC3736B3DBB536E610E925C98BA0DA960256160B050A88C7FE08B99A8EC6878F6D3A907C54",
          "39D2B18F0B2342EA6C18CD54F6C5C99B3FE36B70CD9F48C0F9474B24168A49A889DEACEE025AA2909AE8F53139DE61A4D4BA16A6C97C682B066F5744A0820FF6",
          "560DF89E24A0B9444BA11FB54A98191682E2DB09D77A222D5A90E978E14C14728B98231448425B9E36457D6A9EDBD6D8B083CB0A40DC567541A57FD3A4AFD2BA",
          "0E09770825FE3AEC46BD1FECD11B7888E0CCF7D6C438F07543C9E4D359CA353F77AE3ECC8291FCBC3151055266C05DFD0A9BB0EADDA8849E827C02ED995CD861",
          "7482B4B9146C203F176DDD7586D7607D6A44687C15987B37051982EC53FD350BD1E3CA6C8BFD8FBBB4E3F5CF5DE5815CD1848BBB9746C091D4870A837C9ECCDF",
          "F0140E314EE38D4472393680E7A72A81ABB36B134B467D90EA943B7AA1EA03BF2323BC1A2DF91F7230A225952E162F6629CF435E53404E9CDD727A2D94E4F909",
          "8E5077797FB39431B3ABD4296813ED1D01EFD08A3D76FD26774BEC08F006904DBEE89675AA40D92FDC83B459015881E294FC25B9FC7526C8D1EBDD8A4BCD90BC",
          "34C8A786356D7113DF07BF776CD34103722DC9E72033355F52F0CCA018942F4F7F2CFA6EB933D397C9BE80AA7C06468768193E8BFBD42637788A6269EBC0537D",
          "9D6011F46258958E42C5EDECEA652B71E35137F3D9D467D1A1F46FE42AD20496DE3D937F8BE0F3E202714BAC9F8E7C751AB08E088B83485E33FB511C237E7AE3",
          "7D795FE6A97761D89B35F64E09555951F6EC2A669A9FA03481C100AE158F183E2171E142437D2C3A42352108A22A7E3D797BEAF6C3075DB419B6F4ACCA479C83",
          "FD3D300D34E74E666D8AF9092768CD5CDD801AF9B05DFCD4F1B7C71BBE0F0CF2648BABDA613CE2E115B97EACB6040653C56C855D4ED5991C60EDFB89D5353B52",
          "E5DA4241BDDB144A2B03F523E1EB14796DA91749E264C41A4BCD28816FBCD92988F8547C71B3630AA5C4FB517EB2303102BC137CFE6671784BAD23449CEB3203",
          "A3BD1950B38E9919D714AD9E29064DCBE0F8334E305F317B5C66BB93393A8F3A30298222A2F7C6046A7677980DB9D5CE61D8B2E65437FF9E2C61750BC89C0314",
          "B06923BD6534C6D4D435DCFA7593C4887213AF25CDC9C3F8E854831AF2755E3B229A1F64ED6ACAA471E84850D45BEB43E46E3AAC284E7401C8DA98EC41809AAF",
          "050596C7CF737AF437C007B658619CACADC988450FB62AF4B08784E8AA97ADD8B1FEB38C348E8D0F3781441D709EAB8980BEEA084C584A2A3A2EA2204FB12A4C",
          "1031D4F3514AD382D23862A87E205C279AD8AA71DEC17637DE85DB305492FC298D39A248A4932EC5A9E6889024A5D53C8C8E5AAA9BD146BF53CEF4178A71F1A7",
          "F5D4EB04F41459FFFF2F351BDB3937CC0FB8C15EE5BB7E7EBD0F0B529E9186E9ADB248B10B26198BE4A0C03C6220BB2DA642CDD1FD13A72315B79724D45A352D",
          "3D2971AD8B24391246AF4B2A8D6DFF82D560D44FF32C1251745D60D11E755E1A8FB85C839CA2F77EF12E624233FA6B4F3AB33D2C3F427E57CDDA35C960E25177",
          "32311DF892B57810055BBB4AA59D2667C86BBEF1E32421653A935AD96CE98D657A5ECB86512D964BDD3F810B6902B1A215332C849FA22BE0CE0308E0CD4AFC3C",
          "25CD16F5DCAEB03539A11815571CF7E032A030BD597EFA8A5D8090C4D02F96CCB32E3600291EDA91034722B103E2C5DA95CBFBD7D146039BD0EDB5672870A425",
          "61599C6BC5F657B4A6131A624B2465EC5062912D2CDAC06264B0A0B0F0CC2184A225AE000B80F4C390089B2538EE50300B4C8F5A742799DB10F4A6D1FBDB25AD",
          "AD56C35CAB5063B9E7EA568314EC81C40BA577AAE630DE902004009E88F18DA57BBDFDAAA0FC189C66C8D853248B6B118844D53F7D0BA11DE0F3BFAF4CDD9B3F",
          "8D94B4A10495FF5F98DF8CEB6DF0EB393234D2D2EA83BE500924BFA91C2D660CD0166B52C96D43D322F022E4645EFFC79A5C7C6A3697C408C1106FD1075FE54F",
          "4B3BB1565E8458E97D3101C5116EAAF47415A1FA601A0EAB3517A50CC94EB9CD68CE6B55CCF425DC2E6572134A8B090B7C75DAE16ED74A348B4CD8E77170672F",
          "1B3B125D56842C22C6A8E805AB049FD4B28E752B9A897D6C4DBBE6A6796E2B9C708710EE30D09CF67536A57E7CF94C6F92908EFF193D3E0372A1B152002B9FA4",
          "FFE048FF74E2DB3D82723FB82DE7219921339657D31E0509DA6EA9506FB167C463BCB46F90634B51687CAACFDD3E7D36EB21AAF599062DCA8F85BDCBB26C1CEC",
          "7F1F6F74D04897AF32ED4C858926BD45D05F3AC0C17995D046AE76837AB20116A0FB8A1D9FF260DB8E420A9605A9B0FDAE53BB8894DA4DDD8E57BB634860CFB9",
          "5217A6C342240B89AFE0F8CE41308C98E526157E39F3880033317004BB9FCE09828767D0DD910D8277E42C3DD99BE14EDE30DCFF359800A16DF8C5DF896F63E0",
          "4E53DA197543B710239A47279B2579629450B8A3C4614F82D0875DAB2C0877A6EA45C81FF65B86ED632F01156F34F83BD9FD7F89DE587C6D90C5088393F0D19A",
          "2BBE3D239494F6C0F5C6ACB50C3A3B4C77CB764B4428B5B7E21B69D51DD1A860EB7462B9C0612F8ECEA8C35EF7F4303C5BE656EAF4257125AD1D6B4616354A56",
          "D6A3B2D4C44B4D62F8921EE83553C8738C1084BD7BAA2DDA870BEB821EF1FF96A156A7BC3F06201CC0F4A4467078BAF104CF2D2EE5A839A3322918A3F70191E3",
          "AA6F5D47ED194DD014C7B2F4754E3C69BAF081774CFE640CE2163AF3882FF23FEBEE10DD4DAE4539F62F9A4274DE78B908DF55EFD54197E3D81410BBEC92122E",
          "4BDBA0B7027BDCEA72E9F7F1446348660D2957173EA14B742317911B209C23BFA480F02040C01682E8C65BF174867B8F0D4D14464670E89EB995CB9504FFA17B",
          "500FC170A4E2BEB78DF8D7366F28415706DF533E2AF87E4905BE5056AAF5132B19C64C5D3031980FD41F097BCC0EEFDF07EA7ACD4B95E7436DF04069A1BFC3F1",
          "38F653D8FBDF4302CDA1B0BFF05488F4195C6D9EBCAADA3315CF79640F53368755E5B17F438C6B0E2105D3A2803F4C4BF264491DFAC774783334ADE5E07ABF50",
          "5321113F1DB0C2EA4F619C8419809883AE0CF8E6D921335E53F3EDC021679D1268128E99F306879457B932BB6883A0372ACA189EE80361B530E3FFDA11E8FC0F",
          "EDA12121229BA88FBD8F64AF0F6652DF5D484CDC236A464FF5EE02BF9D894B46566B5EA28CC833F779B47B641E375A6ECEDB86269CE2A33247B6D2F304846F6B",
          "AB9761B6C372A0C2B69D98EC1A1091888891817E99742A910BDB86867E664325C7E66AE49BB31DABA261DCF0EB18D258FD586B1431FCDAA592E598B5299F01C0",
          "E46224610289E99D4762E21EFFB4E39CD14D2BF6F4A1029A8E116C3F9770C58875F1CD7AF7808D262C28888F5BBA818EC9C66A39DFB9282E05F419FB5D6F2ADB",
          "189232076457FC6C5D9236BB5892CC3900039E357CA7B4987DA89B09D617ABA9C9BB49D2F3CFCD2CED3CB1639E98BF76FDBDB20F6ECA94233F10730709234924",
          "62F162CEAA95DA62E692A360D9AED905805971BDE3865BE5D33546A3315CCBCBFEDD82AA1A62A18B40B186E54B114467991183B33542618ECFE8C1F20A5B5A90",
          "6EF1AD2AA2317736F67B38A02DDBF91F155D8372D1BB80638B54B0605960F05B2DD62433634E63122788832422BC8256BE88B12F3DFCCD06E146BCC9C94DA57A",
          "3D802D050BDE13EAEAE2E5D08871F6DE494292581DBEC0163230C623D8B54FCCAD87CC73E9DC107C75DED2772136577D75F1E3E9FFB0A7D9E6F59012D2C47387",
          "6D527EE2F8D03C8AA17FBDDFA9903F4C60AE6938B816D2EB37A943AA3FDE2473856BD9DBC1D55F38D20A05256A092274F8D4318A5D30D0809202F52457556B0A",
          "C6FD5EAC307EC95189671EA599D7CB67F839E837B2B211E09D8D5AA60DD319E2026F7D3005F9FAF4782732E8ACA0F3639CDF92CEC8259F605CFA3F609BB955DB",
          "7783C7978EF6A4858997233CCF0B980794FFCC550E9D8913A7226E5D5F4D44C9C1116AF303AA92BBE81A71AB75A9B498DA48981952F3B51F504B015650BD2D4F",
          "8CD6FB668B47F1AA88FAE1ED17DB54E015F0E22271B1C721FB14F2F5C58CC5E16C5E62B68C3DFE05ADF05A4D97A7FDC15DB99664906CDCC25DD5183DCD1D3301",
          "47658AC3CC7243935DEAB9FDA3F87F1202514DD2DD05C2BCD943140588192849B3A64A9E3B5EA3E3621B08505F707406C9E8B15E5BFF44C1F37F09E127A0604E",
          "E17530A0B557B0FD1431E5CE6788116D1B472F3795791A0DB500E417E44BD5F6FC6B3B4922337BC317CC974C5580E9BDBB001FE69E9BCABECD1D40C4222B79E7",
          "51118106E207D0513D1F2E2B6AFF78E3CC55DED47D3840B014A3383DACFBD4C23DF0472FF3A86EBDBB647B9C96893ED90569556C5F1C47CB8661278B7679265F",
          "02FF1BB0F9139C48D78BE75141B2075279A9B2981EF6EBBDD59A61562B1FEB223B9CE1FDB46CCC5CACCF96087F9E2C1B575CC1464DAE216CA96033C1ED863951",
          "CEA7936BA49787B7F9C1F1885F974DE885ABBF280A523B23637DA1FF41FFE34F2BF4A7374D110C707F7DB97F7799DF8240ECBB9BFD963B76715253985D040AAA",
          "E602EB33A5053B8514E0C615167EC6D3999158F32B6424E6E1A7FEEF524FDBD7F9AA36CA7415F7D21A250B2C69421FD8F9EA7B3D264AF661EBD3D0B39D432AC9",
          "243D92F5A1328A4CC9F4CB6DA60EE6F7B362472F7AD4FC117E3646C85061574C12E110BDFCD98D90F0D19B6BFF5B44A7C69DA1975C3A8522095EB9217E553C28",
          "8D45561A1E1B74796D748A346060B0EDFF3F34002A40702918DE5CD4BCC4A20832B57C9AA2FF8E5803AC21CFBE59A873F7B1E83F4351801B2DB6875FDF69F054",
          "58A98995C10DA3E14AC9D76DB1907232C239C41EBD25C7B5C126A0A7BD4CDF14342D57132B591C7926939811F20A1F3FA7BCBD2FE84B3BA313F93DA45939043B",
          "24E01FBE0536EB995E411C2EC57EDDDC0E7AA6E4C283E1A173A870327AAD054BC35681FA2D0E607A595EC702C9993EC3AC393CC56735DA8B35BE560C90F0FE57",
          "1DB93E38705633009643842F8A65A3CAE361BF679AC456C06667AB5A626698A3C1283D9B405486515F81A6364C389CB4907A1530C756694F3A6805AD0609971F",
          "4A3D943785675C43A6577D936184F8E160F0F82B344F952CA65FF969EC00664279D8CE22DF3F4874CEE0FA6471814CBFAF616FEE9C782F7861291D34257412EB",
          "AD3E8A11A82B0A8A537A6861545715908468ECC210D4BFB46C685B766599A4D323F288F919F13D44BD2674B8002292DE9D08ADA336F907D6CF9BF1C33E3204DC",
          "CD87417194C917561A59C7F2EB4B95145971E32E8E4EF3B23B0F190BFD29E3692CC7975275750A27DF95D5C6A99B7A341E1B8A38A750A51ACA5B77BAE41FBBFC",
          "F8D76FDD8A082A67EAAB47B5518AC486CB9A90DCB9F3C9EFCFD86D5C8B3F1831601D3C8435F84B9E56DA91283D5B98040E6E7B2C8DD9AA5BD4EBDF1823A7CF29",
          "4ED8BA5741D94CAEF309C190BC13D18EB0F16942EBEA76DCF0C6DB1A35311FC04611313EA7D0FF2228A131CD68A84B3872C93D75700601107B6ADDEAFFAA7A90",
          "B87BCE38A829D3A6091C356C8DD561DB1E1EBEC59F03F12D2AE07A7B5117C98F68C13F552669AB316DC8F91D8AFACA06E6E43B6AECDFF2F9E70669A5D5EF9F5C",
          "CAE4089AF8FEA408FF3277D83EA67290A83D7CD9EB1611776D13C4B48F50F261548C2F59F1BC6F8F3CB5C2685780BBB787E66239048A343E4F64C390BB0DF3C3",
          "695375B55F209030E7AC4AF76D739CEE48D2D099A5D985705331B28F99797EEDC69BDCB86058BE72CD9BCF31CCB160E22B96236D4EB69EEFCAAB1BEC5CB1B31C",
          "7218FA1AD53D4C0FF957A5B6F55BBCEB712CFF8BCAB07A1950ABCF5F355262F21E1F92EAD56F203E6C9489DA67977DD81B0CBB62F80CBB7D788D51E2C0BF9DF3",
          "6B8FD1DEEDFF1B2E8AF3A21F32A37FD9E9F5BB3FC946C868492C177370DE6BD9A8E03DFB4591412767C5D34BE32AFC569C5C6C22F67E4D1E171E8A140F9BF8EF",
          "0A12EB12370EB20C563EF4EBFF7B03B6EAA1D378E2C657651453076F460FE972FC218216D2AD70800441E1161ABCA0C36B4B6D24E6B12B7ED1D65E5339E4E96F",
          "C449874BF12798A85265E027FDAE6D670E65A2E74CDD625718A00D52DAE3813FA400F24A8BD9474F3B03D5E3BAEDB2DE32C466E92A0630D70F486D77783C99C4",
          "541BFA78E81724823E60C506569C9B86972CE5C5B30C5229CAA06E88529E74FF3C9C2099A9DEE6FD15A97512D04EEC890207FC3709DBA39264AE8AD13EF53402",
          "0198EBD17DDE325342A98F1D6B2F70D9173C52A5DB97144C3FAE9CC600108343479FF7E9A085F1AACB128D254FF2D94AAA3898140742AAF16B8AA8AB6D81B0A6",
          "71EDA9FA5976F50EDF2438BC2F740FB299F43775A8C22E7EF77AABDF1A2A6C8C65242D9C4467939C5ED271FDE8499B8A88449B0B1206EE9E2A251936E6B46743",
          "5B22E5CC72F405B7B57F213D375A0A84753F1E1D0FBF10B35F7D57BC084A19099C4F86D2A8CD62B00BF7E856E6D6444EA1F4687A2C6870CB9C82E8864C2634DB",
          "DBF28DDD3882288410CE28BE3BCAFAFCB134CE0F31D098B78A036D509072752705832B5DCB841DE1E5CA6805164B18CBA4F33B17D3B176D3D0E364310697B37A",
          "C8360B8D4882F299F8DB8ABBF3CA2BEBDFB1388DB9041B02C1D361688369FD0FC2637DBCAF113A240FB42195C7736A29BE8E91580588BC4CCFCDA071D19C2007",
          "0AC11FE014648130E0E0CDC4CCCBB7B82A62C929553E7A20AF08E032A31B5A56B7081FB42A59C32266BF10C2F9EBE7B8D8DD49A8B195E140C8831AE3CE32098A",
          "5B8C63038D4C577D71FBEDFFF910F276B6547FBEECF3BE23B4E0AA11BF3469B9037302AACACAD62FC13DF70ADC32380B4DE907095F2E2AA3FD34926580D0DEA6",
          "1547F221823E25CC7D395FC51A8961B5FD70D0C0ECB32867B5691A30EE91A69925FDEBD554C2373D4FB008CC4788DB008259B40A2C102EF246561FEB799D0D83",
          "EF18BC1F1A49AA77A7DB75304192B62A4104CE87232F835271D8EB049D406CD6F812FA44CC9EE20B45676827708D37C501DA663D409E0FCA25CA022A9DAA8EF7",
          "091341FA887F50B1CB93D573EFD33441DE81D1C0C0D7D19B49D254F6369A7685D3EF414D798F3D2DCEFCEB3AEABAD8A75AC57A15B3697769797A1C479D9B248A",
          "049646DD0C774FFB8BFC9ACDAE6D6ADA393F5348E3807242BE4D313C251BAE37441CB1999335C44C87D3C3E15D42DC122143708B903618E1A565FACEA955874D",
          "486992DFECC5D1DDE6EA430A01688680013F24324658ADA65522501192B29A4EA6A23A78427F08127D9C5FCB96F078CAD328E89C7E940BFE70A90D4912CE6A7E",
          "EA6B6DEFCD630860500152E812DFF21EC1137734A77DFB9D1826DC87BBDF930A3BF1EAB923D2EC605C00B9B14A1EDA8204EFD8A9067499F07882B8874041F381",
          "0B095D1F69E23477FEA2E1041803C1498DEB43AD3BC1101DDEB791474BF4F1DA5CDD6E8DDC18829B8182956B7AD5DA2BE0C60819C8E8889AA060FBA18E17601F",
          "7E7C8E8BAC0B959204EC45602C92692933C359CFC309A840D206F6C04F9EF6F1EF5AA74B44138ECEBC318E4F7A6351CCFB04EA9F6BDB20A18126A03DC6A6DD47",
          "E5EFFD34575CEE64A550A2BC764B6FD2E1A9930960E7AB1786977069B7B82DC985332E8769BA263EA77B1440B5EC495C1AD78DEB34B8B096DC2D3BB644B3D102",
          "38DD3AC8292FB84113B3FEC177B6C1AE291765D5E24D7E54827079C0F79520204543898403E0C4C298E4970AB564D3925D20942DC78284197052B6CBD6E8B151",
          "053D518ADAAED7249FDEF06F5C70C838673C0BFA764751DC9756952E46293C30F8C0810808209E7CD604DF5D33A990A0084A15830913CCA3299E4802DBBBE55A"]

  @small_tree_exp [["4F7F9525723E2D566229DADCADCDC1F3B196224A66ADCA474BBFCDC1CDA8303D069473FE686EBCC0B0B09F9E71BCB9664D60AE189A3B3081F6252FD47965FA56"],
                   ["0A7B1406BE477B9B994A976A49A236DDF177EA65D04E770264B32C240EB229603F05B573772D406FBB321B8A80F90E73A8EAC5182E2DACB1E93B37C9AE380C37",
                    "71CB4A0B4D323A3D9D6F8188DB4D3266A298053C660A5152AFEBD0782D07820D7AF7E4B1F327E150753FD5CC84B3CF949F33F7A64D62CD764C154F3EEC100F7D",
                    "7127AAB211F82A18D06CF7578FF49D5089017944139AA60D8BEE057811A15FB55A53887600A3ECEBA004DE51105139F32506FE5B53E1913BFA6B32E716FE97DA"]]

  @big_tree_exp [["407FB42B5E0A6A93EEE795440675EE48605BD1F07132DBE6DC4DD1C2221E14538B1E63B5E773203A2B2951DB58BC28ED06C426107B6D56852946AEC606FAC2D0"],
                ["58E51791538701B1D046BF4961B087EC46C3CF70EBFBABEE4FE120A3A5B859CC18840E2FD5FB5B3909B0DA43AB5A12991CD42B557EEFEDE6972EC94F2823A93C",
                 "B82A9D15C8A22DD7B1AE341E5CED513883A4D470188767A250CF6FD586FC15487D233821F3438662CDB7AB1F33814542BB83489D8EF32A3034D42125E603C5F2"],
                ["5DD35685092A6CC1DE8ADDCCAAFAF82D7BC1A3CA81076F0205F9A41C3FCFA64B1A7D5E9E87086CAB38A491502322289FF02E81EA322DAFFD66770F254879E211",
                 "F6E298ECAF92C8B5422624B3E469F4F12B87B6DAC48DEFC8A2D1088BD73AB0A598A0C7B2A69B76900F16A4239A2B274EE9AA5A3AF628B6E502E01C601F9CBD11",
                 "88478DDF014666AF6014A85E1A16163A2F8AB287EA388A2642B91D2F5030CDF2B6C5A696195D12CD573F3C705D9B4F613A2F2A9DDD85A37625DCA51AA5529BD1",
                 "1EF28DF741650703AA10D73D4B8DE5048BDAF4A8A7E9C58E59C603C6A7E29D7398F7B085395FA98F88C35C22FC3A4423958682058116D1992D53F390CB8C28BF",
                 "76F7198950017F4DB9810C7DF09F73634782C9A74AF37CF18661A5FF37FC62AAEDE3D422028175043D456F6E3F3530E4ABCEBF149960F3A2FC0D224A4731CBB8"],
                ["6A5818A7DADBF951BAC982977A267D225FFFA06EBE520EB844171BDC614D60A54EFD9A3246E44BDCE1FE8E82A5C80F610AAFCF807854481027A0B2C157EC789C",
                 "011216AC5BD4FB4C3480EE40D1A2EF4BA847500C4DFC8E54DA13EF1C5411C85199CC0D30D8A472D84924B0DAEE0F1BD93DCACA37B8007D9B405138068A465F58",
                 "F34D9C763554651242FEC4D752FE8451E88B02FBF7E98DBB1BF962893BA952540D72B9CC4CE6D1060044AE82635D1E42469AE8FF5BA1E365719ACF840B11CDDE",
                 "46128AB94C4D509FDCE78191C10EE9433937664155223298ACFA52963BD52AF88F4DFEFC118FE0A66B212CAC72990D767BA1657B064D03CAA2DAB6C925FA8DFC",
                 "223ECAA0957DB0008C241BC9F640B6A074AB9CE577C522808636735F9519167132A105B344E0883D55A97F96230E0359907E218B99EC33163D3C8D4DD1ADD251",
                 "83739DC03E4A288E690AB5651FBB827EAB36CDC71C0CEA439B1EA9DBD679D67F24A6745E429439AF1237F26ADF1DA691B3B5E50949DC092C9E7FA4031C52F1C0",
                 "5E9C6CBA0A1294441CC707F5B72D086DF993FC1BAA5524349D62415DC38B65484D4EA897B80751C341D90988AA8EF199308A9299B91B2A00E45A11D54FBFD724",
                 "BDA186B30317D44541479E00054C2FD605634BE68844F01869B74B16D305E65E78B2450FD7EEB02B0989F6D390626112FB6224252CBFC6C642DC10EFE2E88983",
                 "874E08CCCA90C2B2520EF691E385B659EEEE4E2D8C7AFAE3252297A028071320295B79F0C64D2018157901EB133D31B383E88EE3E03E348216764FE8EE1CE56F",
                 "95A9D8BBBD8F395EDD106F465B0C4CC8A527CED04C3C972A332C70DE47857BD25CB1F6031603705907D6555B91CA2C66704F55DA839EF18CBC51DA7A6E6062CE",
                 "26BA91C353B5CA1EB7B3143D335998482A7B818A2EE79C8672507C4CFA708108E5BE52D38DD197A78F3C74993B11A1B3D453978E05DCEFB3ADAB15E6F2274C09"],
                ["592003A7557045A8EDB22E1C4153DF1113DBCF94BEFAD3CEC930D78558F6A6B2BDE252D6CA9D0C5528EEA00F3D778F5501618BBC731D697ED20346C16B2F2E05",
                 "7D485780CB4565CE3B79AB5069F5971391A9B36C60319329FD3537CB4389574C397AE9407150C477A79B71A7BA61F21FA0E58148299BC6C56FA02CE661C464E0",
                 "02846994D432ABD212A557816AE006F79304AB701333335E4B61AC22DD73E28F80ACBFDFC0C8801818F1B3EED81CFA5103133B8E5AD157F1964D404A728CEBC6",
                 "7A13D4D7792BD424ADC0B6BDDFD3CD19F7DB4856E522C9E70C3EDD3923FC07E776FA5CC7680AABF642B11BED965AA093E3EBBAF8F1C586F7C8F6F4D18EBE9CCF",
                 "39FD1C2AE1477B2435DDEB59010DFF14475591884E55BF479EC1469DF813F26D3F90DB34FFDE1C2ADC8C1545D833F32E187719EDFD3043E95BEA12AF96242047",
                 "3FD5F4C6DD0CDA4B71BC4666B30A8DB677CD3CE0F192E16A6F1AD1C43CE30741AA997D6B97FADC0E2D8901AD99E56878EDEFE57DDF0A9C99D49C120B226D5EA3",
                 "FCBEE129A90D0B7DF14742BB83563E0E813890C8C26005E00A3C28E826050D330179C3CD9E0BE8D6D442AB10F22407DC020530548DF782A0F90F161253C9CACD",
                 "FF38A056A94ED735A1E885D73DFB97DABCB9B5266113DCCBD1CC40B23A646C704819C1DF820BE0546C1F3FF2E91C2EC369E8F0C87F36E3F9B47104EFD48E5356",
                 "8D88477C1CF2CA208C8C541E85F8C19A439AE72B1F69A2CC1CCDCDFE9D91AEB9F6A61381F2F9089A6775E03FBBB90B3F85B5248D2415A0F933506A7DB78A2BBA",
                 "CA8F6AE22DC1735383D187DC4D4B41E89CD97C8AC8C27239225B74812FE5FA7424DCE1F1416146C5F6123B6EE31DA00DA36839DCD8D3E1459B63360D94939F10",
                 "54A2E83B0BF499342B7447DBC81B9ED0168BE91FCB23909D9459D8CFC3755DD5800F0066251627D8721E0AE2754F19AC33D8A32AD4D22E5AD2F9EA70CDC46BCF",
                 "AA67DA46E3E25A3458B42C48582227913565717C2A51D41CEF5CB1A74F6C65F53F25F0AC9EBB0661563F5879A723C238C866E74FFF5EBE804DC92D9367190E98",
                 "C56650915FE6FAB29E88A318043678C2E37D8008F85A9617BAC74724B4C398D50ACF2B64DA6ECFAD99B077039AFBD8BBB63CEC01B050BDE47F14B621192FFAFF",
                 "F19DF127336B7A869A24810D5B833A6A0AA4D4C81C959C165F6690DC69C44D1BFCBF235077239356B3510910E46F726C01F0408CDFEC369027B601D4457AA349",
                 "F1AE05EFF60C2BB2932686FD943F1C4BA8BA8F6A3167C910EF583469480B620FEBFF9413F9D91E03C13F7792A5927382ED42830ADD40DEA95C61D2A0092FE55E",
                 "1EFF1AB801FA580C706361BB1C96D58D1932F568D896E44CA1DCB054FCC66B1BF8E6E28A56F47CCE8D9E2E6310159E1A994C30E654983395F517E031FE309F61",
                 "4D7068D631F69EEDE8F86FB98FF145BB289CD830FD3DCD17DBF0AA751A6D6B82B24BFBDA03FA64AD80A132DA3DD616DEB599178A8545C3EF32A00EEBAD220FD2",
                 "618FFFE8C51F4EB6A5567954D8C413C9384757027E52ACE774D64EC688CBAE5D9A940F2B591A87C1A9C0F2E104507C00D4A3F1E98F0628CD8B718581EDB8BCA5",
                 "16630681C9FD070FE425975444AC9F758A941E4CE8A0A020B19035B35DEEF3F3BAE113A7BF798F6393A1D53F6534D3F80D5A4C214297F3FD45C7491AFD040F71",
                 "959DF7709AC33111A8AD52233C3601D363AFE3601CDCB7979E7B2F15867E3C6D0845166D60A6193609C3D7269FA79C8D3830E2C50E275AFE0952FDD257D716FA",
                 "0BC18BC2983930A1A46B88FA22BCFD3EE0005833469F40B14AC44AE9965F5CED032BC039FF3348995053CBEBCCB3013F44851EC33B8B0B68008A0BF00B520FCD",
                 "4F7F9525723E2D566229DADCADCDC1F3B196224A66ADCA474BBFCDC1CDA8303D069473FE686EBCC0B0B09F9E71BCB9664D60AE189A3B3081F6252FD47965FA56"],
                ["38F653D8FBDF4302CDA1B0BFF05488F4195C6D9EBCAADA3315CF79640F53368755E5B17F438C6B0E2105D3A2803F4C4BF264491DFAC774783334ADE5E07ABF50",
                 "500FC170A4E2BEB78DF8D7366F28415706DF533E2AF87E4905BE5056AAF5132B19C64C5D3031980FD41F097BCC0EEFDF07EA7ACD4B95E7436DF04069A1BFC3F1",
                 "4BDBA0B7027BDCEA72E9F7F1446348660D2957173EA14B742317911B209C23BFA480F02040C01682E8C65BF174867B8F0D4D14464670E89EB995CB9504FFA17B",
                 "AA6F5D47ED194DD014C7B2F4754E3C69BAF081774CFE640CE2163AF3882FF23FEBEE10DD4DAE4539F62F9A4274DE78B908DF55EFD54197E3D81410BBEC92122E",
                 "D6A3B2D4C44B4D62F8921EE83553C8738C1084BD7BAA2DDA870BEB821EF1FF96A156A7BC3F06201CC0F4A4467078BAF104CF2D2EE5A839A3322918A3F70191E3",
                 "2BBE3D239494F6C0F5C6ACB50C3A3B4C77CB764B4428B5B7E21B69D51DD1A860EB7462B9C0612F8ECEA8C35EF7F4303C5BE656EAF4257125AD1D6B4616354A56",
                 "4E53DA197543B710239A47279B2579629450B8A3C4614F82D0875DAB2C0877A6EA45C81FF65B86ED632F01156F34F83BD9FD7F89DE587C6D90C5088393F0D19A",
                 "5217A6C342240B89AFE0F8CE41308C98E526157E39F3880033317004BB9FCE09828767D0DD910D8277E42C3DD99BE14EDE30DCFF359800A16DF8C5DF896F63E0",
                 "7F1F6F74D04897AF32ED4C858926BD45D05F3AC0C17995D046AE76837AB20116A0FB8A1D9FF260DB8E420A9605A9B0FDAE53BB8894DA4DDD8E57BB634860CFB9",
                 "FFE048FF74E2DB3D82723FB82DE7219921339657D31E0509DA6EA9506FB167C463BCB46F90634B51687CAACFDD3E7D36EB21AAF599062DCA8F85BDCBB26C1CEC",
                 "1B3B125D56842C22C6A8E805AB049FD4B28E752B9A897D6C4DBBE6A6796E2B9C708710EE30D09CF67536A57E7CF94C6F92908EFF193D3E0372A1B152002B9FA4",
                 "4B3BB1565E8458E97D3101C5116EAAF47415A1FA601A0EAB3517A50CC94EB9CD68CE6B55CCF425DC2E6572134A8B090B7C75DAE16ED74A348B4CD8E77170672F",
                 "8D94B4A10495FF5F98DF8CEB6DF0EB393234D2D2EA83BE500924BFA91C2D660CD0166B52C96D43D322F022E4645EFFC79A5C7C6A3697C408C1106FD1075FE54F",
                 "AD56C35CAB5063B9E7EA568314EC81C40BA577AAE630DE902004009E88F18DA57BBDFDAAA0FC189C66C8D853248B6B118844D53F7D0BA11DE0F3BFAF4CDD9B3F",
                 "61599C6BC5F657B4A6131A624B2465EC5062912D2CDAC06264B0A0B0F0CC2184A225AE000B80F4C390089B2538EE50300B4C8F5A742799DB10F4A6D1FBDB25AD",
                 "25CD16F5DCAEB03539A11815571CF7E032A030BD597EFA8A5D8090C4D02F96CCB32E3600291EDA91034722B103E2C5DA95CBFBD7D146039BD0EDB5672870A425",
                 "32311DF892B57810055BBB4AA59D2667C86BBEF1E32421653A935AD96CE98D657A5ECB86512D964BDD3F810B6902B1A215332C849FA22BE0CE0308E0CD4AFC3C",
                 "3D2971AD8B24391246AF4B2A8D6DFF82D560D44FF32C1251745D60D11E755E1A8FB85C839CA2F77EF12E624233FA6B4F3AB33D2C3F427E57CDDA35C960E25177",
                 "F5D4EB04F41459FFFF2F351BDB3937CC0FB8C15EE5BB7E7EBD0F0B529E9186E9ADB248B10B26198BE4A0C03C6220BB2DA642CDD1FD13A72315B79724D45A352D",
                 "1031D4F3514AD382D23862A87E205C279AD8AA71DEC17637DE85DB305492FC298D39A248A4932EC5A9E6889024A5D53C8C8E5AAA9BD146BF53CEF4178A71F1A7",
                 "050596C7CF737AF437C007B658619CACADC988450FB62AF4B08784E8AA97ADD8B1FEB38C348E8D0F3781441D709EAB8980BEEA084C584A2A3A2EA2204FB12A4C",
                 "B06923BD6534C6D4D435DCFA7593C4887213AF25CDC9C3F8E854831AF2755E3B229A1F64ED6ACAA471E84850D45BEB43E46E3AAC284E7401C8DA98EC41809AAF",
                 "A3BD1950B38E9919D714AD9E29064DCBE0F8334E305F317B5C66BB93393A8F3A30298222A2F7C6046A7677980DB9D5CE61D8B2E65437FF9E2C61750BC89C0314",
                 "E5DA4241BDDB144A2B03F523E1EB14796DA91749E264C41A4BCD28816FBCD92988F8547C71B3630AA5C4FB517EB2303102BC137CFE6671784BAD23449CEB3203",
                 "FD3D300D34E74E666D8AF9092768CD5CDD801AF9B05DFCD4F1B7C71BBE0F0CF2648BABDA613CE2E115B97EACB6040653C56C855D4ED5991C60EDFB89D5353B52",
                 "7D795FE6A97761D89B35F64E09555951F6EC2A669A9FA03481C100AE158F183E2171E142437D2C3A42352108A22A7E3D797BEAF6C3075DB419B6F4ACCA479C83",
                 "9D6011F46258958E42C5EDECEA652B71E35137F3D9D467D1A1F46FE42AD20496DE3D937F8BE0F3E202714BAC9F8E7C751AB08E088B83485E33FB511C237E7AE3",
                 "34C8A786356D7113DF07BF776CD34103722DC9E72033355F52F0CCA018942F4F7F2CFA6EB933D397C9BE80AA7C06468768193E8BFBD42637788A6269EBC0537D",
                 "8E5077797FB39431B3ABD4296813ED1D01EFD08A3D76FD26774BEC08F006904DBEE89675AA40D92FDC83B459015881E294FC25B9FC7526C8D1EBDD8A4BCD90BC",
                 "F0140E314EE38D4472393680E7A72A81ABB36B134B467D90EA943B7AA1EA03BF2323BC1A2DF91F7230A225952E162F6629CF435E53404E9CDD727A2D94E4F909",
                 "7482B4B9146C203F176DDD7586D7607D6A44687C15987B37051982EC53FD350BD1E3CA6C8BFD8FBBB4E3F5CF5DE5815CD1848BBB9746C091D4870A837C9ECCDF",
                 "0E09770825FE3AEC46BD1FECD11B7888E0CCF7D6C438F07543C9E4D359CA353F77AE3ECC8291FCBC3151055266C05DFD0A9BB0EADDA8849E827C02ED995CD861",
                 "560DF89E24A0B9444BA11FB54A98191682E2DB09D77A222D5A90E978E14C14728B98231448425B9E36457D6A9EDBD6D8B083CB0A40DC567541A57FD3A4AFD2BA",
                 "39D2B18F0B2342EA6C18CD54F6C5C99B3FE36B70CD9F48C0F9474B24168A49A889DEACEE025AA2909AE8F53139DE61A4D4BA16A6C97C682B066F5744A0820FF6",
                 "B8B697048ECCEB141A7AD801A21A9459C2DB367D7A3699401BAC77DC3736B3DBB536E610E925C98BA0DA960256160B050A88C7FE08B99A8EC6878F6D3A907C54",
                 "E12F775ADFB4E440B74AF7B670849A44B7EFD1612A97A3A201080CB31944F1F2D9F0EAE6B7C0CDB602F6FF0BA181ADD9997FD06E43F992DF577AA52153CA0D27",
                 "259CED9D6AF7A7D157938A10D617E480B1E5D498D8B1AA6F854A90AC4639917E4FC03DCF05EA49FC2B50CAB81F32C4D6B38396FF7975F22342F0050E88870F3A",
                 "0ADE1DB9CC8552ED5997A5642D835EBD191367D08C24564A735A16F777EC7A0F02E7575E5C778E39D6CDFA79006CD96BC4B40967ABBC23B9109EED2F296AF8F6",
                 "0A28B1EEBA45E166119CE95B6CF76B24946BA8DADAA4B7C10AFF72272BFEF3AF1408ED34F1AAE2C8F65EDFC29F0CA8997A9DC9C6953484A0F2DE1A35E0278168",
                 "68782E54497296A64B14987023A61F96B741B1F2F7FF6095552569A2252783C85C99E9FA43273A196FFA0FF72697C3449682175C6272B8586DEF3CED6E701B37",
                 "BDA962340F636E37E98903953944CFE22D8F1EF6B564E5BEA44A575F2500648F35E286F7A6DBBB26E52246151A6CD055ED7370173A2927A9683F25143844FFA8",
                 "82BB78ACCCED463DB810E506218AD1CE4D702491A4921D55075985BADB2CF73C1F9D9035CA83CF383505DCBEA17542943ECDC9E4C476D1C0A97C891AF6F2772B",
                 "0A7B1406BE477B9B994A976A49A236DDF177EA65D04E770264B32C240EB229603F05B573772D406FBB321B8A80F90E73A8EAC5182E2DACB1E93B37C9AE380C37",
                 "71CB4A0B4D323A3D9D6F8188DB4D3266A298053C660A5152AFEBD0782D07820D7AF7E4B1F327E150753FD5CC84B3CF949F33F7A64D62CD764C154F3EEC100F7D",
                 "7127AAB211F82A18D06CF7578FF49D5089017944139AA60D8BEE057811A15FB55A53887600A3ECEBA004DE51105139F32506FE5B53E1913BFA6B32E716FE97DA"]]

  @closed_tree_exp [["413E264904070C6A7D0B5BDD4922F3E5C7434B46D8477B6F79F4D448F83A794ED0C3C5DD643E61D49EF3FC2078A3ED17CD0EB740CF5D094087D1BA9F3075F4D7"],
                   ["C2E0EF5A5C0901164124803615957E4FB425CAC1E23629C85056A49D91F6B112122E25339F4AA62276FF5C03D22EBEC5B5E15C7E5FCD7885E1A68AA4D29994C9",
                    "4F7F9525723E2D566229DADCADCDC1F3B196224A66ADCA474BBFCDC1CDA8303D069473FE686EBCC0B0B09F9E71BCB9664D60AE189A3B3081F6252FD47965FA56"],
                   ["06D7BA765C343B98975776842E8E6BB97FE0EE03A8A4F37F7DEEA0B7298FD282B73BAEC045052BC6B664F25A531CA099B82484566CF3267077BEBF5708A127E8",
                    "0A7B1406BE477B9B994A976A49A236DDF177EA65D04E770264B32C240EB229603F05B573772D406FBB321B8A80F90E73A8EAC5182E2DACB1E93B37C9AE380C37",
                    "71CB4A0B4D323A3D9D6F8188DB4D3266A298053C660A5152AFEBD0782D07820D7AF7E4B1F327E150753FD5CC84B3CF949F33F7A64D62CD764C154F3EEC100F7D",
                    "7127AAB211F82A18D06CF7578FF49D5089017944139AA60D8BEE057811A15FB55A53887600A3ECEBA004DE51105139F32506FE5B53E1913BFA6B32E716FE97DA"]]

  @small_proof_exp ["0BC18BC2983930A1A46B88FA22BCFD3EE0005833469F40B14AC44AE9965F5CED032BC039FF3348995053CBEBCCB3013F44851EC33B8B0B68008A0BF00B520FCD",
                     "71CB4A0B4D323A3D9D6F8188DB4D3266A298053C660A5152AFEBD0782D07820D7AF7E4B1F327E150753FD5CC84B3CF949F33F7A64D62CD764C154F3EEC100F7D"]

  @big_proof_exp ["2B52BEC06373907AADCACADEF4DF91C66F607E0D66723CFA460836595B2F793299506CDBBD273B84514E1D30ABFF76316074C2982A43D95C4905C34764D3D5AD",
                  "58E51791538701B1D046BF4961B087EC46C3CF70EBFBABEE4FE120A3A5B859CC18840E2FD5FB5B3909B0DA43AB5A12991CD42B557EEFEDE6972EC94F2823A93C",
                  "1EF28DF741650703AA10D73D4B8DE5048BDAF4A8A7E9C58E59C603C6A7E29D7398F7B085395FA98F88C35C22FC3A4423958682058116D1992D53F390CB8C28BF",
                  "95A9D8BBBD8F395EDD106F465B0C4CC8A527CED04C3C972A332C70DE47857BD25CB1F6031603705907D6555B91CA2C66704F55DA839EF18CBC51DA7A6E6062CE",
                  "0BC18BC2983930A1A46B88FA22BCFD3EE0005833469F40B14AC44AE9965F5CED032BC039FF3348995053CBEBCCB3013F44851EC33B8B0B68008A0BF00B520FCD",
                  "71CB4A0B4D323A3D9D6F8188DB4D3266A298053C660A5152AFEBD0782D07820D7AF7E4B1F327E150753FD5CC84B3CF949F33F7A64D62CD764C154F3EEC100F7D"]

  def sized_tree size, offset \\ 0 do
    {:ok, pid} = Tree.new
    for n <- (1 + offset)..(size + offset) do
      Tree.push pid, {Enum.at(@hashes, n), {}}, 0
    end
    pid
  end

  test "sha3_512" do
    assert @foo == :sha3.hexhash(512, "foo")
  end

  test "small tree growth" do
    pid = sized_tree 3
    {res, _} = Tree.get pid
    assert @small_tree_exp == res
  end

  test "big tree growth" do
    pid = sized_tree 45
    {res, _} = Tree.get pid
    assert @big_tree_exp == res
  end

  test "tree closing" do
    pid = sized_tree 3
    root = Tree.close pid
    {tree, _} = Tree.get pid
    assert [[^root],[_,_],[_,_,_,_]] = tree
  end

  test "small tree proofing" do
    pid = sized_tree 4
    hash = @hashes |> Enum.at(1)
    Tree.close pid
    assert @small_proof_exp =
      with {_, proofs} <- Tree.get(pid),
           {proof, _}  <- Map.get(proofs, hash),
      do: proof
  end

  test "big tree proofing" do
    pid = sized_tree 64
    hash = @hashes |> Enum.at(1)
    Tree.close pid
    assert @big_proof_exp =
      with {_, proofs} <- Tree.get(pid),
           {proof, _}  <- Map.get(proofs, hash),
      do: proof
  end


end
